-# TODO v4 rewrite, simply and add better classes
- cache "#{product.cache_key}/prices", expires_in: Workarea.config.cache_expirations.product_pricing_fragment_cache do
  - if product.one_price?
    %p.product-prices__price
      - if product.show_sell_range?
        %span.product-prices__sell-price.product-prices__sell-price--min
          = render 'workarea/storefront/products/price', price: product.sell_min_price, sku: product.sell_min_price_sku, flow_price_attr: 'TODO', local_prices: 'TODO'
        %span.product-prices__sell-price.product-prices__sell-price--max
          –
          %span{ data: { flow: { item_number: product.sell_max_price_sku.id } } }
            %span{ data: { flow_price_attr: 'TODO', local_prices: 'TODO' } }= number_to_currency product.sell_max_price
      - else
        %span.product-prices__sell-price
          = render 'workarea/storefront/products/price', price: product.sell_min_price, sku: 'TODO', flow_price_attr: 'TODO', local_prices: 'TODO'

  - else
    - if product.on_sale?
      %p.product-prices__price.product-prices__price--on-sale
        - if product.show_sell_range?
          %strong.product-prices__sell-price.product-prices__sell-price--min
            = render 'workarea/storefront/products/price', price: product.sell_min_price, sku: 'TODO', flow_price_attr: 'TODO', local_prices: 'TODO'
          %strong.product-prices__sell-price.product-prices__sell-price--max
            –
            %span{ data: { flow: { item_number: 'TODO' } } }
              %span{ data: { flow_price_attr: 'TODO', local_prices: 'TODO' } }= number_to_currency product.sell_max_price
        - else
          %strong.product-prices__sell-price
            = render 'workarea/storefront/products/price', price: product.sell_min_price, sku: 'TODO', flow_price_attr: 'TODO', local_prices: 'TODO'

    - else
      %p.product-prices__price
        - if product.show_sell_range?
          %span.product-prices__sell-price.product-prices__sell-price--min
            = render 'workarea/storefront/products/price', price: product.sell_min_price, sku: product.sell_min_price_sku, flow_price_attr: product.sell_min_price_sku.sell_price_key, local_prices: product.localized_sell_min_prices
          %span.product-prices__sell-price.product-prices__sell-price--max
            –
            %span{ data: { flow: { item_number: product.sell_max_price_sku.id } } }
              %spam{ data: { local_prices: product.localized_sell_max_prices.to_json, flow_price_attr: product.sell_max_price_sku.sell_price_key } }= number_to_currency product.sell_max_price
        - else
          %span.product-prices__sell-price
            = render 'workarea/storefront/products/price', price: product.sell_min_price, sku: product.sell_min_price_sku, flow_price_attr: product.sell_min_price_sku.sell_price_key, local_prices: product.localized_sell_min_prices

    %p.product-prices__price.product-prices__price--original
      - if product.show_original_range?
        %s.product-prices__original-price.product-prices__original-price--range
          %span{ data: { flow: { item_number: product.original_min_price_sku.id } } }
            %span{ data: { flow_price_attr: product.original_min_price_attribute, local_prices: product.localized_original_min_prices.to_json }}
              #{number_to_currency product.original_min_price}
            –
          %span{ data: { flow: { item_number: product.original_max_price_sku.id } } }
            %span{ data: { flow_price_attr: product.original_max_price_attribute, local_prices: product.localized_original_max_prices.to_json } }
              #{number_to_currency product.original_max_price}
      - else
        %s.product-prices__original-price{ data: { flow: { item_number: product.original_min_price_sku.id } } }
          %span{ data: { flow_price_attr: product.original_min_price_attribute, local_prices: product.localized_original_min_prices.to_json } }
            = number_to_currency product.original_min_price
